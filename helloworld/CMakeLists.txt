#######################################
# Generated By CMake Generator v1.2.7 #
#######################################

#if want toolchain setting
if(NOT DEFINED CMAKE_TOOLCHAIN_FILE)
    set(CMAKE_TOOLCHAIN_FILE "${CMAKE_CURRENT_LIST_DIR}/toolchain/arm-none-eabi-gcc.cmake")
endif()
#or
#cmake -DCMAKE_TOOLCHAIN_FILE="" ..

set(CMAKE_EXPORT_COMPILE_COMMANDS True CACHE INTERNAL "")

cmake_minimum_required(VERSION 3.19)
project(hello
    VERSION 0.0.0
    DESCRIPTION "hello Project"
    HOMEPAGE_URL ""
)
set(DOXYGEN_PROJECT_NAME "hello")

# specify the C/C++ standard
enable_language(C CXX ASM)
if(NOT DEFINED CMAKE_CXX_STANDARD_REQUIRED)
    set(CMAKE_CXX_STANDARD 17)
    set(CMAKE_CXX_STANDARD_REQUIRED True)
endif()
if(NOT DEFINED CMAKE_C_STANDARD_REQUIRED)
    set(CMAKE_C_STANDARD 17)
    set(CMAKE_C_STANDARD_REQUIRED True)
endif()

if("${CMAKE_BUILD_TYPE}" STREQUAL "")
    set(CMAKE_BUILD_TYPE "RelWithDebInfo")
endif()

set(compile_options
    #add an option to all of language
    $<$<BOOL:${SIZE_OPTIMIZE_ENABLE}>:-DSIZE_OPTIMIZE_ENABLE>
    -Wall
    -ftree-vectorize
    -fopt-info-vec-all=auto_vectorize_info.txt

    #add an option to specific build type
    $<$<CONFIG:Release>:$<IF:$<BOOL:${SIZE_OPTIMIZE_ENABLE}>,-Os,-O2>>

    $<$<CONFIG:RelWithDebInfo>:$<IF:$<BOOL:${SIZE_OPTIMIZE_ENABLE}>,-Os,-O2>>
    $<$<CONFIG:RelWithDebInfo>:-gdwarf-4>

    $<$<CONFIG:Debug>:$<IF:$<BOOL:${SIZE_OPTIMIZE_ENABLE}>,-Os,-Og>>
    $<$<CONFIG:Debug>:-gdwarf-4>
    $<$<CONFIG:Debug>:-DDEBUG>

    #add an option to specific language
    #$<$<COMPILE_LANGUAGE:C>:-DC_DEF>
    #$<$<COMPILE_LANGUAGE:CXX>:-DCXX_DEF>
)

set(link_options

)

set(link_directory_list
    "${CMAKE_CURRENT_LIST_DIR}/lib/${CMAKE_SYSTEM_PROCESSOR}"

)

set(header_directory_list
    "${CMAKE_CURRENT_LIST_DIR}/include"
)

set(source_directory_list
    "${CMAKE_CURRENT_LIST_DIR}/src"
)

set(source_exclude_pattern
    ""
)

set(docs_exclude_pattern
    ""
)
option(DOCS_AUTO_BUILD_DISABLE "Disable Document Auto Generate When Release or RelWithDebInfo Mode" True)
option(DOCS_INSTALL_DISABLE "Disable Document Install" True)

set(CPACK_DEBIAN_PACKAGE_MAINTAINER "KJW")
set(CPACK_DEBIAN_PACKAGE_DEPENDS "systemd")
set(CPACK_RPM_PACKAGE_REQUIRES "systemd")
set(CPPCHECK_EXTRA_OPTION
    #If you want to suppress some path, use this format
    # "[error id]:[path]:[line]"
    #    - [error id] can be wildcard '*'
    #    - will suppress if the check target path includes the [path]
    #    - :[line] is optional
    ""
)

include(${CMAKE_CURRENT_LIST_DIR}/Common.cmake)

add_executable(${PROJECT_NAME} ${source_file_list})
target_link_directories(${PROJECT_NAME} PUBLIC ${link_directory_list})
target_include_directories(${PROJECT_NAME} PUBLIC ${header_directory_list})
target_compile_options(${PROJECT_NAME} PUBLIC ${compile_options})
target_link_options(${PROJECT_NAME} PUBLIC ${link_options})
target_compile_options(${PROJECT_NAME} PRIVATE
    -DVERSION="v${PROJECT_VERSION}"
    -DVERSION_MAJOR=${PROJECT_VERSION_MAJOR}
    -DVERSION_MINOR=${PROJECT_VERSION_MINOR}
    -DVERSION_PATCH=${PROJECT_VERSION_PATCH}
    -DCOMMIT_HASH="${COMMIT_HASH}"
)

include_directories(${header_directory_list}) #for subproject
add_compile_options(${compile_options}) #for subproject
add_link_options(${link_options}) #for subproject

install(TARGETS ${PROJECT_NAME} DESTINATION bin)

target_link_options(${PROJECT_NAME} PRIVATE -Wl,-demangle,-Map,$<TARGET_FILE:${PROJECT_NAME}>.map)
add_custom_target(${PROJECT_NAME}_LIST ALL DEPENDS ${PROJECT_NAME} COMMENT "Generate $<TARGET_FILE:${PROJECT_NAME}>.lst"
    COMMAND ${CMAKE_OBJDUMP} -SC $<TARGET_FILE:${PROJECT_NAME}> > $<TARGET_FILE:${PROJECT_NAME}>.lst
)

#if want include subproject
#add_subdirectory(${CMAKE_CURRENT_LIST_DIR}/subproject)

#target_link_libraries(${PROJECT_NAME} cmake_target_name)

#if want cmake modules based library link
#find_package(Threads REQUIRED)
#target_link_libraries(${PROJECT_NAME} pthread)

#if want pkg-config based library link
#find_package(PkgConfig REQUIRED)
#pkg_check_modules(LIBPNG REQUIRED IMPORTED_TARGET libpng)
#target_link_libraries(${PROJECT_NAME} PkgConfig::LIBPNG)

