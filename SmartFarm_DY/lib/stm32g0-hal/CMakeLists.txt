#######################################
# Generated By CMake Generator v1.2.7 #
#######################################

#if want toolchain setting
if(NOT DEFINED CMAKE_TOOLCHAIN_FILE)
    set(CMAKE_TOOLCHAIN_FILE "")
endif()
#or
#cmake -DCMAKE_TOOLCHAIN_FILE="" ..

set(CMAKE_EXPORT_COMPILE_COMMANDS True CACHE INTERNAL "")

cmake_minimum_required(VERSION 3.19)
project(STM32G0_HAL
    VERSION 1.6.2
    DESCRIPTION "STM32G0 HAL Library"
    HOMEPAGE_URL "https://git.xslab.co.kr/xslab/stm32-sdk/stm32g0-hal"
)

# specify the C/C++ standard
enable_language(C CXX ASM)
if(NOT DEFINED CMAKE_CXX_STANDARD_REQUIRED)
    set(CMAKE_CXX_STANDARD 17)
    set(CMAKE_CXX_STANDARD_REQUIRED True)
endif()
if(NOT DEFINED CMAKE_C_STANDARD_REQUIRED)
    set(CMAKE_C_STANDARD 17)
    set(CMAKE_C_STANDARD_REQUIRED True)
endif()

if("${CMAKE_BUILD_TYPE}" STREQUAL "")
    set(CMAKE_BUILD_TYPE "RelWithDebInfo")
endif()

option(SDK_MSP_IT_DISABLE "Disable stm32g0xx_it.c and stm32g0xx_hal_msp.c" False)

set(compile_options
    #add an option to all of language
    $<$<BOOL:${SIZE_OPTIMIZE_ENABLE}>:-DSIZE_OPTIMIZE_ENABLE>
    -Wall
    -ftree-vectorize
    -fopt-info-vec-all=auto_vectorize_info.txt
    -DUSE_HAL_DRIVER

    #add an option to specific build type
    $<$<CONFIG:Release>:$<IF:$<BOOL:${SIZE_OPTIMIZE_ENABLE}>,-Os,-O2>>

    $<$<CONFIG:RelWithDebInfo>:$<IF:$<BOOL:${SIZE_OPTIMIZE_ENABLE}>,-Os,-O2>>
    $<$<CONFIG:RelWithDebInfo>:-gdwarf-4>

    $<$<CONFIG:Debug>:$<IF:$<BOOL:${SIZE_OPTIMIZE_ENABLE}>,-Os,-Og>>
    $<$<CONFIG:Debug>:-gdwarf-4>
    $<$<CONFIG:Debug>:-DDEBUG>

    #add an option to specific language
    #$<$<COMPILE_LANGUAGE:C>:-DC_DEF>
    #$<$<COMPILE_LANGUAGE:CXX>:-DCXX_DEF>
)

set(link_options

)

set(link_directory_list
    "${CMAKE_CURRENT_LIST_DIR}/lib/${CMAKE_SYSTEM_PROCESSOR}"
    "${CMAKE_CURRENT_LIST_DIR}/extra/ldscripts"
)

set(header_directory_list
    "${CMAKE_CURRENT_LIST_DIR}/lib/CMSIS/Include"
    "${CMAKE_CURRENT_LIST_DIR}/lib/CMSIS/Device/ST/STM32G0xx/Include"
    "${CMAKE_CURRENT_LIST_DIR}/lib/STM32G0xx_HAL_Driver/Inc/Legacy"
    "${CMAKE_CURRENT_LIST_DIR}/lib/STM32G0xx_HAL_Driver/Inc"
)

set(source_directory_list
    "${CMAKE_CURRENT_LIST_DIR}/src"
    "${CMAKE_CURRENT_LIST_DIR}/lib/CMSIS"
    "${CMAKE_CURRENT_LIST_DIR}/lib/STM32G0xx_HAL_Driver"
)

if(SDK_MSP_IT_DISABLE)
set(source_exclude_pattern
    "${CMAKE_CURRENT_LIST_DIR}/src/stm32g0xx_hal_msp.c"
    "${CMAKE_CURRENT_LIST_DIR}/src/stm32g0xx_it.c"
)
else()
list(APPEND header_directory_list "${CMAKE_CURRENT_LIST_DIR}/include")
set(source_exclude_pattern
    ""
)
endif()

set(docs_exclude_pattern
    ""
)
option(DOCS_AUTO_BUILD_DISABLE "Disable Document Auto Generate When Release or RelWithDebInfo Mode" True)
option(DOCS_INSTALL_DISABLE "Disable Document Install" True)

set(CPACK_DEBIAN_PACKAGE_MAINTAINER "KJW")
set(CPACK_DEBIAN_PACKAGE_DEPENDS "systemd")
set(CPACK_RPM_PACKAGE_REQUIRES "systemd")

include(${CMAKE_CURRENT_LIST_DIR}/Common.cmake)

add_library(stm32g0-hal OBJECT ${source_file_list})
target_link_directories(stm32g0-hal PUBLIC ${link_directory_list})
target_include_directories(stm32g0-hal PUBLIC ${header_directory_list})
target_compile_options(stm32g0-hal PUBLIC ${compile_options})
target_link_options(stm32g0-hal PUBLIC ${link_options})
target_compile_options(stm32g0-hal PRIVATE
    -DVERSION="v${PROJECT_VERSION}"
    -DVERSION_MAJOR=${PROJECT_VERSION_MAJOR}
    -DVERSION_MINOR=${PROJECT_VERSION_MINOR}
    -DVERSION_PATCH=${PROJECT_VERSION_PATCH}
    -DCOMMIT_HASH="${COMMIT_HASH}"
)

include_directories(${header_directory_list}) #for subproject
add_compile_options(${compile_options}) #for subproject
add_link_options(${link_options}) #for subproject

#if want include subproject
#add_subdirectory(${CMAKE_CURRENT_LIST_DIR}/subproject)

#target_link_libraries(stm32g0-hal cmake_target_name)

#if want cmake modules based library link
#find_package(Threads REQUIRED)
#target_link_libraries(stm32g0-hal pthread)

#if want pkg-config based library link
#find_package(PkgConfig REQUIRED)
#pkg_check_modules(LIBPNG REQUIRED IMPORTED_TARGET libpng)
#target_link_libraries(stm32g0-hal PkgConfig::LIBPNG)

